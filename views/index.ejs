<!-- views/index.ejs -->
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>ブログ一覧</title>
  <style>
    body { max-width: 720px; margin: 24px auto; font-family: system-ui, sans-serif; }
    form { padding: 16px; border: 1px solid #ddd; border-radius: 8px; margin-bottom: 24px; }
    .post { border-bottom: 1px solid #eee; padding: 12px 0; }
    .post h2 { margin: 0 0 4px; font-size: 20px; }
    .muted { color: #666; font-size: 12px; }
    textarea { width: 100%; height: 120px; }
    input[type="text"], input[type="date"] { width: 100%; }
    button { padding: 8px 14px; }
  </style>
</head>
<body>
  <h1>ブログ投稿</h1>

  <form action="/" method="POST">
    <div>
      <label>タイトル</label><br />
      <input type="text" name="title" required />
    </div>
    <div style="margin-top:8px;">
      <label>日付（省略可）</label><br />
      <input type="date" name="date" />
    </div>
    <div style="margin-top:8px;">
      <label>本文</label><br />
      <textarea name="content" required></textarea>
    </div>
    <div style="margin-top:12px;">
      <button type="submit">投稿する</button>
    </div>
  </form>

  <!-- 検索フォーム -->
  <form action="/search" method="GET" style="margin-bottom: 20px;">
    <input type="text" name="q" placeholder="キーワードを入力" required />
    <button type="submit">検索</button>
  </form>

  <h1>記事一覧</h1>
  <% if (!blogs || blogs.length === 0) { %>
    <p>まだ記事がありません。</p>
  <% } else { %>
    <% for (let i = 0; i < blogs.length; i++) { %>
      <div class="post">
        <h2><%= blogs[i].title %></h2>
        <div class="muted">
          投稿日:
          <% /* PrismaはDate型を返すのでISO文字列で日付表示 */ %>
          <%= blogs[i].date.toISOString().slice(0,10) %>
        </div>
        <p><%= blogs[i].content %></p>
      </div>
    <% } %>
  <% } %>
</body>
</html>
